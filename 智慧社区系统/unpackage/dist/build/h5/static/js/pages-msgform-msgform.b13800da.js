(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-msgform-msgform"],{"11cb":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return n}));var n={homecom:i("7bd3").default},a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"mainext"},[i("cu-custom",{attrs:{bgColor:"bg-gradual-blue",isBack:!0}},[i("template",{attrs:{slot:"content"},slot:"content"},[e._v("信息录入")])],2),e.loadModal?i("v-uni-view",{staticClass:"cu-load load-modal"},[i("v-uni-view",{staticClass:"gray-text"},[e._v("上传中...")]),i("v-uni-view",{staticClass:"gray-text",staticStyle:{"font-size":"0.8em"}},[e._v("当前进度："+e._s(e.gresslenjkm))])],1):e._e(),i("homecom",{staticClass:"homclass"}),i("v-uni-view",{staticClass:"formcontent"},[i("v-uni-form",[i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("姓名")],1),i("v-uni-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("手机号")],1),i("v-uni-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("项目类型")],1),i("v-uni-picker",{attrs:{value:e.form.indexitem,range:e.pickeritem},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.PickerChangeitem.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.indexitem>-1?e.pickeritem[e.indexitem]:"请选择"))])],1)],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("组别或班级")],1),i("v-uni-picker",{attrs:{value:e.form.indexgroup,range:e.pickergroup},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.PickerChangegroup.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.indexgroup>-1?e.pickergroup[e.indexgroup]:"请选择"))])],1)],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("单位")],1),i("v-uni-input",{attrs:{placeholder:"请输入单位"},model:{value:e.form.unit,callback:function(t){e.$set(e.form,"unit",t)},expression:"form.unit"}})],1),i("v-uni-view",{staticClass:"cu-bar bg-white margin-top",staticStyle:{"border-top":"0.5px solid #eee"}},[i("v-uni-view",{staticClass:"action"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("健康码截图")],1),i("v-uni-view",{staticClass:"action"},[e._v(e._s(e.imgListjkm.length)+"/1")])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[e._l(e.imgListjkm,(function(t,n){return i("v-uni-view",{key:n,staticClass:"bg-img",attrs:{"data-url":e.imgListjkm[n]},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ViewImagejkm.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:e.imgListjkm[n],mode:"aspectFill"}}),i("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":n},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.DelImgjkm.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),e.imgListjkm.length<1?i("v-uni-view",{staticClass:"solids",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ChooseImagejkm.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):e._e()],2)],1),i("v-uni-view",{staticClass:"cu-bar bg-white margin-top",staticStyle:{"border-top":"0.5px solid #eee"}},[i("v-uni-view",{staticClass:"action"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("行程码截图")],1),i("v-uni-view",{staticClass:"action"},[e._v(e._s(e.imgListxck.length)+"/1")])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[e._l(e.imgListxck,(function(t,n){return i("v-uni-view",{key:n,staticClass:"bg-img",attrs:{"data-url":e.imgListxck[n]},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ViewImagexck.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:e.imgListxck[n],mode:"aspectFill"}}),i("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":n},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.DelImgxck.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),e.imgListxck.length<1?i("v-uni-view",{staticClass:"solids",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ChooseImagexck.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):e._e()],2)],1),i("v-uni-view",{staticClass:"cu-bar bg-white margin-top",staticStyle:{"border-top":"0.5px solid #eee"}},[i("v-uni-view",{staticClass:"action"},[i("v-uni-text",{staticClass:"requireclass"},[e._v("*")]),e._v("本人照片")],1),i("v-uni-view",{staticClass:"action"},[e._v(e._s(e.imgListuser.length)+"/1")])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[e._l(e.imgListuser,(function(t,n){return i("v-uni-view",{key:n,staticClass:"bg-img",attrs:{"data-url":e.imgListuser[n]},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ViewImageuser.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:e.imgListuser[n],mode:"aspectFill"}}),i("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":n},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.DelImguser.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),e.imgListuser.length<1?i("v-uni-view",{staticClass:"solids",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ChooseImageuser.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):e._e()],2)],1)],1),i("v-uni-view",{staticClass:"margin-top submitbut"},[i("v-uni-button",{staticClass:"cu-btn block bg-blue margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交")])],1)],1),i("v-uni-view",{staticClass:"bottomcontet"},[e._v("提示：上传照片用于海培门禁系统人员识别")]),i("br")],1)},r=[]},"128d":function(e,t,i){"use strict";i.r(t);var n=i("11cb"),a=i("2d77");for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("e64b");var s,o=i("f0c5"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"2b04e4f5",null,!1,n["a"],s);t["default"]=c.exports},"2d77":function(e,t,i){"use strict";i.r(t);var n=i("e4ac"),a=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},"72d2":function(e,t,i){"use strict";var n=i("4ea4");i("ace4"),i("d3b7"),i("ac1f"),i("466d"),i("1276"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("2954"),i("649e"),i("219c"),i("b39a"),i("72f7"),Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExif=r,t.processIosImage=s,t.imageProcess=c,t.fillTextToImage=u,t.compressImage=v,t.base64ToFile=t.dataURItoFile=t.fileToDataURI=void 0,i("96cf");var a=n(i("1da1"));function r(e){return new Promise((function(t,i){EXIF.getData(e,(function(){t(EXIF.getAllTags(this))}))}))}function s(e){return o.apply(this,arguments)}function o(){return o=(0,a.default)(regeneratorRuntime.mark((function e(t){var i,n,a,s,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=o.length>1&&void 0!==o[1]?o[1]:.8,e.prev=1,e.next=4,r(t);case 4:if(n=e.sent,a=n.Orientation,6!==a){e.next=11;break}return e.next=9,c(t,i,!0);case 9:return s=e.sent,e.abrupt("return",s);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](1),console.log(e.t0);case 16:return e.abrupt("return",t);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),o.apply(this,arguments)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.92,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(n,a){var r=e.name,s=window.webkitURL.createObjectURL(e),o=new Image;o.src=s,o.onload=function(){console.log("图片加载完成",o.height,o.width);var e=o.width,a=o.height,s=document.createElement("canvas"),c=s.getContext("2d");i?(s.width=a,s.height=e,c.fillStyle="#fff",c.fillRect(0,0,s.width,s.height),c.rotate(90*Math.PI/180),c.drawImage(o,0,-a,e,a)):(s.width=e,s.height=a,c.fillStyle="#fff",c.fillRect(0,0,s.width,s.height),c.drawImage(o,0,0,e,a));var u=s.toDataURL("image/jpeg",t),l=m(u,r);n(l)}}))}function u(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:35,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"red",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Promise((function(r,s){var o=window.webkitURL.createObjectURL(e),c=new Image;c.src=o,c.onload=function(){var s=document.createElement("canvas"),o=s.getContext("2d");s.width=c.width,s.height=c.height,console.log(c.width,c.height),o.fillStyle="#fff",o.fillRect(0,0,s.width,s.height),o.drawImage(c,0,0,s.width,s.height);var u=s.width/i;o.font=u+"px serif",o.fillStyle=n,o.shadowColor="rgba(0,0,0,0.71)",o.shadowOffsetX=2,o.shadowOffsetY=2,o.shadowBlur=2;var l=.3*u;a<1&&(a=s.height*a);for(var d=0;d<t.length;d++)o.fillText(t[d],u,s.height-a-(u+l)*(d+1));var g=m(s.toDataURL("image/jpeg"),e.name);r(g)}}))}var l=function(e){return e&&window.FileReader?new Promise((function(t,i){var n=new window.FileReader;n.readAsDataURL(e),n.onloadend=function(){t(n.result)}})):console.log("环境不支持")};t.fileToDataURI=l;var m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",i=e.split(","),n=i[0].match(/:(.*?);/)[1],a=atob(i[1]),r=a.length,s=new Uint8Array(r);while(r--)s[r]=a.charCodeAt(r);return new File([s],t,{type:n})};t.dataURItoFile=m;var d=500,g=200;function v(e){return f.apply(this,arguments)}function f(){return f=(0,a.default)(regeneratorRuntime.mark((function e(t){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=p(d),!(t.size<i)){e.next=3;break}return e.abrupt("return",t);case 3:return n=window.webkitURL.createObjectURL(t),e.next=6,w(n,t);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function p(e){return 1024*e}var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=e.split(","),a="",r="",s="";1===n.length?a=n[0]:2===n.length&&(a=n[1],r=n[0].match(/:(.*?);/)),!i&&r&&r.length>=2&&(s=r[1]);var o=atob(a),c=o.length,u=new Uint8Array(c);while(c--)u[c]=o.charCodeAt(c);return new File([u],t,{type:i||s})};function w(e,t){return k.apply(this,arguments)}function k(){return k=(0,a.default)(regeneratorRuntime.mark((function e(t,i){var n,a,r,s,o,c,u,l,m=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(u=function(){return new Promise((function(e,a){var r=new Image;r.src=t,r.onload=function(){var t=r.width*n,a=r.height*n,s=document.createElement("canvas"),o=s.getContext("2d");s.width=t,s.height=a,o.drawImage(r,0,0,t,a);var c=s.toDataURL("image/jpeg",n);e(h(c,i.name))},r.onerror=function(e){a(e)}}))},n=m.length>2&&void 0!==m[2]?m[2]:.5,a=m.length>3&&void 0!==m[3]?m[3]:5,r=p(g),s=p(d),o=1,c=0,a--){e.next=11;break}return e.abrupt("return",i);case 11:if(!(i.size<r)){e.next=15;break}n=(o+n)/2,e.next=20;break;case 15:if(!(i.size>s)){e.next=19;break}n=(c+n)/2,e.next=20;break;case 19:return e.abrupt("return",i);case 20:return e.next=22,u();case 22:return l=e.sent,e.next=25,w(t,l,n,a);case 25:return e.abrupt("return",e.sent);case 26:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}t.base64ToFile=h},ccb6:function(e,t,i){var n=i("f6b1");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("50b2922e",n,!0,{sourceMap:!1,shadowMode:!1})},e4ac:function(e,t,i){"use strict";var n=i("4ea4");i("4160"),i("a434"),i("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var a=n(i("1da1")),r=(i("dad4"),i("72d2"),n(i("dee2"))),s=n(i("7bd3")),o=r.default.httpUrl,c={mounted:function(){this.init()},components:{homecom:s.default},data:function(){return{form:{name:"",mobile:"",unit:""},indexitem:-1,pickeritem:[],pickeritemArr:[],indexgroup:-1,pickergroup:[],pickergroupArr:[],indexuser:-1,pickeruser:["唐春","杨舟"],imgListjkm:[],imgListxck:[],imgListuser:[],flagfk:!0,loading:!0,gresslenjkm:"0%",loadModal:!1}},methods:{init:function(){this.getEnumsfun();var e=uni.getStorageSync("loginuserinfo");this.form.name=e.trueName,this.form.mobile=e.mobile},getEnumsfun:function(){var e=this;return(0,a.default)(regeneratorRuntime.mark((function t(){var i,n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new e.Request(e.Urls.m().getEnums).modeget();case 2:i=t.sent,n=i.data.projectTypeEnum.option,e.pickeritemArr=n,a=[],n.forEach((function(e,t){a.push(e.label)})),e.pickeritem=a;case 8:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this;return(0,a.default)(regeneratorRuntime.mark((function t(){var i,n,a,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i="",n=e.transval(e.pickeritemArr,"label",e.pickeritem[e.indexitem],"value"),a=e.transval(e.pickergroupArr,"projectName",e.pickergroup[e.indexgroup],"projectId"),r={approvalStaffId:i,avatarUrl:e.imgListuser[0],healthyCodeUrl:e.imgListjkm[0],mobile:e.form.mobile,organization:e.form.unit,projectId:a,projectType:n,tripCodeUrl:e.imgListxck[0],trueName:e.form.name},t.next=6,new e.Request(e.Urls.m().hpProjectApplySave,r).modepost();case 6:s=t.sent,"0"==s.code&&uni.navigateTo({url:"../msgsuccess/msgsuccess"});case 8:case"end":return t.stop()}}),t)})))()},PickerChangeitem:function(e){var t=this;return(0,a.default)(regeneratorRuntime.mark((function i(){var n,a,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.indexitem=e.detail.value,console.log(t.pickeritem[t.indexitem]),"访客"==t.pickeritem[t.indexitem]?t.flagfk=!0:t.flagfk=!1,n=t.transval(t.pickeritemArr,"label",t.pickeritem[t.indexitem],"value"),i.next=6,new t.Request(t.Urls.m().getHpProjects+"?projectType="+n).modeget();case 6:a=i.sent,console.log(a.data),t.pickergroupArr=a.data,r=[],t.pickergroupArr.forEach((function(e,t){r.push(e.projectName)})),t.pickergroup=r;case 12:case"end":return i.stop()}}),i)})))()},PickerChangegroup:function(e){this.indexgroup=e.detail.value},PickerChangeuser:function(e){this.indexuser=e.detail.value},ChooseImagejkm:function(){var e=this,t=this;uni.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(){var i=(0,a.default)(regeneratorRuntime.mark((function i(n){var a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.gresslenjkm="0%",e.loadModal=!0,a=uni.uploadFile({url:"".concat(o,"/hp-entrance/minio/file/upload"),filePath:n.tempFilePaths[0],name:"file",header:{Authorization:uni.getStorageSync("accessLink")},formData:{user:"test"},success:function(e){t.loadModal=!1,console.log(JSON.parse(e.data).data),t.imgListjkm=[JSON.parse(e.data).data]}}),a.onProgressUpdate((function(e){t.gresslenjkm=e.progress+"%"}));case 4:case"end":return i.stop()}}),i)})));function n(e){return i.apply(this,arguments)}return n}()})},ViewImagejkm:function(e){uni.previewImage({urls:this.imgListjkm,current:e.currentTarget.dataset.url})},DelImgjkm:function(e){var t=this;uni.showModal({content:"确定要删除吗？",cancelText:"取消",confirmText:"确定",success:function(i){i.confirm&&t.imgListjkm.splice(e.currentTarget.dataset.index,1)}})},ChooseImagexck:function(){var e=this,t=this;uni.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(i){t.gresslenjkm="0%",e.loadModal=!0;var n=uni.uploadFile({url:"".concat(o,"/hp-entrance/minio/file/upload"),filePath:i.tempFilePaths[0],name:"file",header:{Authorization:uni.getStorageSync("accessLink")},formData:{user:"test"},success:function(e){t.loadModal=!1,console.log(e),t.imgListxck=[JSON.parse(e.data).data]}});n.onProgressUpdate((function(e){t.gresslenjkm=e.progress+"%"}))}})},ViewImagexck:function(e){uni.previewImage({urls:this.imgListxck,current:e.currentTarget.dataset.url})},DelImgxck:function(e){var t=this;uni.showModal({content:"确定要删除吗？",cancelText:"取消",confirmText:"确定",success:function(i){i.confirm&&t.imgListxck.splice(e.currentTarget.dataset.index,1)}})},ChooseImageuser:function(){var e=this,t=this;uni.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(i){t.gresslenjkm="0%",e.loadModal=!0;var n=uni.uploadFile({url:"".concat(o,"/hp-entrance/minio/file/upload"),filePath:i.tempFilePaths[0],name:"file",header:{Authorization:uni.getStorageSync("accessLink")},formData:{user:"test"},success:function(i){t.loadModal=!1,console.log(i),e.imgListuser=[JSON.parse(i.data).data]}});n.onProgressUpdate((function(e){t.gresslenjkm=e.progress+"%"}))}})},ViewImageuser:function(e){uni.previewImage({urls:this.imgListuser,current:e.currentTarget.dataset.url})},DelImguser:function(e){var t=this;uni.showModal({content:"确定要删除吗？",cancelText:"取消",confirmText:"确定",success:function(i){i.confirm&&t.imgListuser.splice(e.currentTarget.dataset.index,1)}})},transval:function(e,t,i,n){for(var a=0;a<e.length;a++){var r=e[a];if(r[t]==i)return r[n]}}}};t.default=c},e64b:function(e,t,i){"use strict";var n=i("ccb6"),a=i.n(n);a.a},f6b1:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,".submitbut[data-v-2b04e4f5]{padding:15px}.bottomcontet[data-v-2b04e4f5]{width:100%;text-align:center;font-size:.8em;color:#000;font-weight:700;margin-bottom:10%}.gressclass[data-v-2b04e4f5]{height:5px!important}",""]),e.exports=t}}]);